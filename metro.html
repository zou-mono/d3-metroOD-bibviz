<!DOCTYPE html><html lang="en"><head>    <meta charset="UTF-8">    <title>Title</title>    <!--<script src="js/d3.min.js" type="text/javascript"></script>-->    <link rel="stylesheet" href="css/metro.css"/>    <script src="https://d3js.org/d3.v5.min.js" type="text/JavaScript"></script>    <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.2.8/d3.min.js" type="text/JavaScript"></script>--></head><body><svg height="500" id="station-chart" width="1200"></svg><div id="selected"> Hover over a line or bar to show more info about a contradiction, chapter or book.</div><script>    var station_array = [];    var station_color = {        1: "#006400",        2: "#FF9000",        3: "#00BFFF",        4: "#FF0000",        5: "#9A32FF",        7: "#0000FF",        9: "#8B5F65",        11: "#8B0000"    };    // if (!window.maxArcs) {    //     var maxArcs = 10;    // }    // 去除重复元素    function uniqueArray(arr) {        let r = [];        if (!arr) return r;        for (let i = 0, l = arr.length; i < l; i++) {            for (let j = i + 1; j < l; j++)                if (arr[i] === arr[j]) j = ++i;            r.push(arr[i]);        }        return r;    }    d3.select('#selected').transition().delay(7000).duration(1000).style('opacity', 1.0);    d3.csv('data/station_flow.csv').then(function (data) {        bData = data;        for (let i = 0; i < bData.length; i++) {            if (station_array.indexOf(bData[i].ZDMC) === -1) station_array.push(bData[i].ZDMC);        }        var svg = d3.select('#station-chart');        var maxFLOW = d3.max(data, d => parseInt(d.TOTAL_FLOW));        var minFLOW = d3.min(data, d => parseInt(d.TOTAL_FLOW));        var yScale = d3.scaleLinear().domain([minFLOW, maxFLOW]).range([0, 100]);        svg.selectAll('rect')            .data(data)            .enter().append('rect')            .attr('x', function (d, i) {                return i * 5 + 5;            })            .attr('y', 400)            .attr('width', 5)            .attr('height', d => yScale(parseInt(d.TOTAL_FLOW)))            .attr('fill', d => station_color[parseInt(d.LineNO)]) //[parseInt(d.lineNO)]            // .attr('fill', "#006400")            .on('mouseover', function (d) {                d3.select('#selected')                    .html(d.ZDMC + '<br/><span class="subdued">全天总客流量' +                        d.TOTAL_FLOW + '<br/> 全天进站客流量' + d.IN_FLOW +                        '<br/> 全天出站客流量' + d.OUT_FLOW);            });        d3.csv('data/OD.csv').then(function (data) {            // for (let i = 0; i < station_array.length; i++) {            //     console.log(data.filter(d=>(d.FROM_STATION === station_array[i] || d.TO_STATION === station_array[i])));            // }            for (let i = 0; i < data.length; i++) {                console.log(data.filter(                    d => (d.FROM_STATION === data[i].FROM_STATION && d.TO_STATION === data[i].TO_STATION) ||                        (d.FROM_STATION === data[i].TO_STATION && d.TO_STATION === data[i].FROM_STATION)));            }        });    });</script></body></html>